<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#047857">
    <meta name="description" content="Aplikasi Dzikir & Doa Qurani Premium">
    
    <!-- PWA Settings -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Dzikir & Doa Qurani</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400&family=Inter:wght@400;500;600;700&family=Scheherazade+New:wght@400;700&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- TYPOGRAPHY SETUP --- */
        @font-face {
            font-family: 'LPMQ Isep Misbah';
            src: url('https://lpmq.kemenag.go.id/public/font/LPMQ_IsepMisbah.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        :root {
            --font-ui: 'Inter', system-ui, -apple-system, sans-serif;
            --font-arabic: 'LPMQ Isep Misbah', 'Scheherazade New', 'Amiri', serif;
            --primary: #047857; 
            --bg-light: #f8fafc;
        }

        body {
            font-family: var(--font-ui);
            background-color: #f1f5f9; /* Slate 100 for desktop bg */
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: none;
        }

        /* Responsive Background for Desktop */
        @media (min-width: 768px) {
            body {
                background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23cbd5e1' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
                display: flex;
                align-items: center;
                justify-content: center;
                min-height: 100vh;
                padding: 20px;
            }
        }

        /* Specialized Arabic Styling */
        .font-arabic {
            font-family: var(--font-arabic);
            line-height: 2.6; /* Sedikit dilonggarkan */
            font-feature-settings: "kern" 1, "liga" 1;
        }

        /* Utility: Hide Scrollbar but keep functionality */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        /* Islamic Pattern (Inside App) */
        .islamic-pattern {
            background-color: #ffffff;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23047857' fill-opacity='0.04'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
    </style>
</head>
<body>

    <!-- === APP CONTAINER === -->
    <!-- 
        Responsive Logic:
        - Mobile: w-full h-screen (Full immersive)
        - Desktop: max-w-lg (Tablet size), rounded corners, shadow (Floating App feel)
    -->
    <main id="app-root" class="w-full h-screen bg-white shadow-2xl overflow-hidden relative
        md:h-[85vh] md:w-[480px] md:max-w-lg md:rounded-[2.5rem] md:border-8 md:border-white md:ring-1 md:ring-gray-200">
        <!-- Content injected via JS -->
    </main>

    <!-- === JAVASCRIPT LOGIC === -->
    <script>
        // ==========================================
        // 1. DATABASE & CONFIG
        // ==========================================
        
        // Ganti dengan URL Google Apps Script Anda jika sudah di-deploy
        const SCRIPT_URL = ""; 

        // Data Default (Offline/Fallback)
        let DB = {
            dzikirPagi: [
                {
                    id: 1, title: "Ayat Kursi",
                    arabic: "اللَّهُ لَا إِلَٰهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ ۚ لَا تَأْخُذُهُ سِنَةٌ وَلَا نَوْمٌ ۚ لَهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الْأَرْضِ ۗ مَنْ ذَا الَّذِي يَشْفَعُ عِنْدَهُ إِلَّا بِإِذْنِهِ ۚ يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ ۖ وَلَا يُحِيطُونَ بِشَيْءٍ مِنْ عِلْمِهِ إِلَّا بِمَا شَاءَ ۚ وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالْأَرْضَ ۖ وَلَا يَئُودُهُ حِفْظُهُمَا ۚ وَهُوَ الْعَلِيُّ الْعَظِيمُ",
                    latin: "Allāhu lā ilāha illā huwal-ḥayyul-qayyūm...",
                    translation: "Allah, tidak ada Tuhan (yang berhak disembah) melainkan Dia Yang Hidup kekal lagi terus menerus mengurus (makhluk-Nya)...",
                    faedah: "Dibaca pagi & petang. Melindungi dari gangguan jin.",
                    count: 1
                },
                {
                    id: 2, title: "Al-Ikhlas",
                    arabic: "بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ\nقُلْ هُوَ اللَّهُ أَحَدٌ ۝ اللَّهُ الصَّمَدُ ۝ لَمْ يَلِدْ وَلَمْ يُولَدْ ۝ وَلَمْ يَكُنْ لَهُ كُفُوًا أَحَدٌ",
                    translation: "Katakanlah: Dialah Allah, Yang Maha Esa...",
                    faedah: "Mencukupkan segala sesuatu.",
                    count: 3
                },
                {
                    id: 3, title: "Al-Falaq",
                    arabic: "بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ\nقُلْ أَعُوذُ بِرَبِّ الْفَلَقِ ۝ مِنْ شَرِّ مَا خَلَقَ ۝ وَمِنْ شَرِّ غَاسِقٍ إِذَا وَقَبَ ۝ وَمِنْ شَرِّ النَّفَّاثَاتِ فِي الْعُقَدِ ۝ وَمِنْ شَرِّ حَاسِدٍ إِذَا حَسَدَ",
                    translation: "Aku berlindung kepada Tuhan Yang Menguasai subuh...",
                    count: 3
                },
                {
                    id: 4, title: "An-Naas",
                    arabic: "بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ\nقُلْ أَعُوذُ بِرَبِّ النَّاسِ ۝ مَلِكِ النَّاسِ ۝ إِلَٰهِ النَّاسِ ۝ مِنْ شَرِّ الْوَسْوَاسِ الْخَنَّاسِ ۝ الَّذِي يُوَسْوِسُ فِي صُدُورِ النَّاسِ ۝ مِنَ الْجِنَّةِ وَالنَّاسِ",
                    translation: "Aku berlindung kepada Tuhannya manusia...",
                    count: 3
                }
            ],
            dzikirPetang: [
                 { id: 1, title: "Ayat Kursi", arabic: "اللَّهُ لَا إِلَٰهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ...", translation: "(Lihat teks lengkap di Dzikir Pagi)", count: 1 },
                 { id: 2, title: "Doa Sore", arabic: "أَمْسَيْنَا وَأَمْسَى الْمُلْكُ لِلَّهِ...", translation: "Kami telah memasuki waktu sore...", count: 1 }
            ],
            doaHarian: [
                { id: 1, title: "Doa Sebelum Makan", arabic: "اللَّهُمَّ بَارِكْ لَنَا فِيمَا رَزَقْتَنَا وَقِنَا عَذَابَ النَّارِ", translation: "Ya Allah berkahilah rezeki kami..." },
                { id: 2, title: "Doa Bangun Tidur", arabic: "الْحَمْدُ لِلَّهِ الَّذِي أَحْيَانَا بَعْدَ مَا أَمَاتَنَا وَإِلَيْهِ النُّشُورُ", translation: "Segala puji bagi Allah yang menghidupkan kami..." }
            ],
            dzikirShalat: [
                { id: 1, title: "Istighfar (3x)", arabic: "أَسْتَغْفِرُ اللهَ الْعَظِـيْمَ", translation: "Aku memohon ampun kepada Allah...", count: 3 },
                { id: 2, title: "Tasbih, Tahmid, Takbir", arabic: "سُبْحَانَ اللهِ (٣٣×)   الْحَمْدُ لِلَّهِ (٣٣×)   اللهُ أَكْبَرُ (٣٣×)", translation: "Maha Suci Allah, Segala Puji bagi Allah, Allah Maha Besar.", count: 33 }
            ],
            doaQurani: [
                { id: 1, title: "Doa Sapu Jagat", arabic: "رَبَّنَا آتِنَا فِي الدُّنْيَا حَسَنَةً وَفِي الْآخِرَةِ حَسَنَةً وَقِنَا عَذَابَ النَّارِ", source: "QS. Al-Baqarah: 201", translation: "Ya Tuhan kami, berilah kami kebaikan di dunia dan akhirat..." },
                { id: 2, title: "Doa Kesabaran", arabic: "رَبَّنَا أَفْرِغْ عَلَيْنَا صَبْرًا وَثَبِّتْ أَقْدَامَنَا", source: "QS. Al-Baqarah: 250", translation: "Ya Tuhan kami, tuangkanlah kesabaran..." }
            ],
            belajarTajwid: [
                { id: 1, title: "Idzhar Halqi", content: "Nun mati/tanwin bertemu (ء ه ع ح غ خ), dibaca JELAS.", example: "مَنْ آمَنَ" },
                { id: 2, title: "Iqlab", content: "Nun mati/tanwin bertemu Ba (ب), bunyi N berubah jadi M.", example: "مِنْ بَعْدِ" }
            ]
        };

        // Fetch Data from Google Sheets
        async function fetchData() {
            if(!SCRIPT_URL) return;
            try {
                const response = await fetch(SCRIPT_URL);
                const json = await response.json();
                DB = json;
                if (AppState.currentView !== 'home') {
                    // Refresh view if user is already looking at something
                   render(AppState.currentView, { 
                       type: AppState.currentView === 'slider' ? 'dzikirPagi' : 'belajarTajwid',
                       title: 'Dzikir Pagi',
                       rtl: true 
                   });
                }
            } catch (error) {
                console.log("Mode Offline / Demo Data Active");
            }
        }

        // ==========================================
        // 2. STATE & ROUTER
        // ==========================================
        const AppState = {
            currentView: 'home',
            data: null,
            currentIndex: 0,
            isRTL: false
        };

        const root = document.getElementById('app-root');

        function navigateTo(viewName, params = null) {
            root.style.opacity = '0.7';
            setTimeout(() => {
                AppState.currentView = viewName;
                AppState.currentIndex = 0; 
                render(viewName, params);
                root.style.opacity = '1';
                root.scrollTop = 0;
            }, 100);
        }

        function render(view, params) {
            root.innerHTML = '';
            switch(view) {
                case 'home': renderHome(); break;
                case 'slider': renderSliderView(params.type, params.title, params.rtl); break;
                case 'list': renderListView(params.type, params.title); break;
                default: renderHome();
            }
        }

        // ==========================================
        // 3. UI RENDERERS
        // ==========================================

        function renderHome() {
            const hour = new Date().getHours();
            let greeting = "Assalamualaikum";
            let subGreeting = hour >= 10 && hour < 15 ? "Selamat Siang" : 
                              hour >= 15 && hour < 18 ? "Selamat Sore" : 
                              hour >= 18 ? "Selamat Malam" : "Selamat Pagi";

            const quotes = [
                "Basahi lisanmu dengan Dzikir.",
                "Shalat adalah tiang agama.",
                "Ingatlah Allah, hati akan tenang."
            ];
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];

            // RESPONSIVE GRID: grid-cols-2 (Mobile) -> grid-cols-3 (Desktop/Tablet)
            // MENU HEIGHT: Fixed height for consistent layout
            
            const html = `
                <div class="h-full flex flex-col islamic-pattern relative animate-fade-in bg-white">
                    <!-- Hero Section -->
                    <div class="pt-12 pb-6 px-6 text-center z-10">
                        <p class="text-emerald-600 font-medium text-xs tracking-[0.2em] uppercase mb-2 opacity-90">${greeting}</p>
                        <h1 class="text-3xl md:text-4xl font-bold text-slate-800 mb-3 tracking-tight">${subGreeting}</h1>
                        <div class="h-1 w-12 bg-emerald-200 mx-auto rounded-full mb-3"></div>
                        <p class="text-slate-500 text-sm font-light italic">"${randomQuote}"</p>
                    </div>

                    <!-- Menu Grid Container -->
                    <div class="flex-grow overflow-y-auto hide-scrollbar px-6 pb-24">
                        <div class="grid grid-cols-2 md:grid-cols-2 gap-4 auto-rows-fr">
                            ${MenuCard("Dzikir Pagi", "fa-sun", "slider", {type: 'dzikirPagi', title: 'Dzikir Pagi', rtl: true})}
                            ${MenuCard("Dzikir Petang", "fa-cloud-moon", "slider", {type: 'dzikirPetang', title: 'Dzikir Petang', rtl: true})}
                            ${MenuCard("Doa Qurani", "fa-quran", "slider", {type: 'doaQurani', title: 'Doa-Doa Qurani', rtl: true})}
                            ${MenuCard("Doa Harian", "fa-hands-praying", "slider", {type: 'doaHarian', title: 'Doa Harian', rtl: false})}
                            ${MenuCard("Dzikir Shalat", "fa-mosque", "slider", {type: 'dzikirShalat', title: 'Dzikir Setelah Shalat', rtl: true})} 
                            ${MenuCard("Belajar Tajwid", "fa-book-open", "list", {type: 'belajarTajwid', title: 'Belajar Tajwid'})}
                        </div>
                    </div>

                    <!-- Footer -->
                    <div class="absolute bottom-0 w-full p-4 bg-gradient-to-t from-white via-white to-transparent text-center z-20 pointer-events-none">
                        <p class="text-[10px] text-gray-400 font-medium tracking-wide uppercase">© Ahmad Dawami</p>
                    </div>
                </div>
            `;
            root.innerHTML = html;
        }

        function MenuCard(title, icon, targetView, params) {
            const paramsStr = JSON.stringify(params).replace(/"/g, "&quot;");
            // Improved Card UI for Desktop hover states
            return `
                <button onclick="navigateTo('${targetView}', ${paramsStr})" 
                    class="group relative bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex flex-col items-center justify-center gap-3 transition-all duration-300 hover:shadow-md hover:border-emerald-200 hover:-translate-y-1 h-32 md:h-36">
                    <div class="w-12 h-12 rounded-full bg-emerald-50 text-emerald-600 flex items-center justify-center text-xl group-hover:bg-emerald-600 group-hover:text-white transition-colors duration-300">
                        <i class="fa-solid ${icon}"></i>
                    </div>
                    <span class="text-sm font-semibold text-slate-700 leading-tight">${title}</span>
                </button>
            `;
        }

        function renderSliderView(dataType, title, isRTL) {
            const data = DB[dataType] || [];
            AppState.data = data;
            AppState.currentIndex = 0;
            AppState.isRTL = isRTL;

            const flexDir = isRTL ? 'flex-row-reverse' : 'flex-row';
            const trackWidth = data.length * 100;

            const html = `
                <div class="h-full flex flex-col bg-white animate-fade-in relative">
                    <!-- Header -->
                    <div class="flex items-center justify-between px-4 py-4 border-b border-gray-100 z-30 bg-white/95 backdrop-blur-sm sticky top-0 h-16">
                        <button onclick="navigateTo('home')" class="w-10 h-10 flex items-center justify-center text-slate-500 hover:bg-slate-100 rounded-full transition-colors">
                            <i class="fa-solid fa-arrow-left"></i>
                        </button>
                        <h2 class="text-lg font-bold text-slate-800 tracking-tight">${title}</h2>
                        <div class="w-10 h-10 flex items-center justify-center text-emerald-600 font-bold text-xs bg-emerald-50 rounded-full">
                            <span id="slide-indicator">1/${data.length}</span>
                        </div>
                    </div>

                    <!-- Slider Viewport -->
                    <div class="flex-grow relative overflow-hidden slider-viewport bg-slate-50">
                        <!-- Track -->
                        <div id="slides-track" class="h-full flex ${flexDir} items-stretch transition-transform duration-300 ease-out will-change-transform" 
                             style="width: ${trackWidth}%; touch-action: pan-y;">
                            ${data.map((item) => SliderCard(item, data.length)).join('')}
                        </div>
                    </div>

                    <!-- Controls -->
                    <div class="p-5 pb-8 border-t border-gray-100 bg-white z-30 flex justify-between items-center shadow-[0_-4px_20px_rgba(0,0,0,0.03)] h-24">
                        <button onclick="handleNavClick(-1)" class="w-12 h-12 rounded-full bg-slate-50 text-slate-600 hover:bg-slate-200 flex items-center justify-center text-lg active:scale-95 transition-all">
                            <i class="fa-solid fa-chevron-left"></i>
                        </button>
                        
                        <div class="flex gap-1.5 overflow-hidden max-w-[120px]">
                            ${data.map((_, i) => `<div id="dot-${i}" class="w-1.5 h-1.5 rounded-full ${i===0?'bg-emerald-500':'bg-gray-300'} transition-colors"></div>`).join('')}
                        </div>
                        
                        <button onclick="handleNavClick(1)" class="w-12 h-12 rounded-full bg-emerald-600 text-white shadow-lg hover:bg-emerald-700 flex items-center justify-center text-lg active:scale-95 transition-all">
                            <i class="fa-solid fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            `;
            root.innerHTML = html;
            initSwipeLogic();
            
            // Re-calc on resize to prevent drift
            window.addEventListener('resize', updateSlidePosition);
        }

        function SliderCard(item, totalItems) {
            // Precise width: 100% of the VIEWPORT width (which is 100/totalItems % of the TRACK width)
            const width = 100 / totalItems;
            
            const faedah = item.faedah ? 
                `<div class="mt-6 mx-4 p-4 bg-amber-50 rounded-xl text-sm text-amber-900 border border-amber-100 leading-relaxed shadow-sm">
                    <strong class="block text-amber-700 mb-1 text-xs uppercase tracking-wide"><i class="fa-solid fa-star mr-1"></i> Keutamaan</strong>
                    ${item.faedah}
                </div>` : "";
            
            const count = item.count ? 
                `<div class="inline-flex items-center justify-center bg-emerald-100 text-emerald-700 font-bold text-xs px-3 py-1.5 rounded-full mb-6 shadow-sm">
                    <i class="fa-solid fa-rotate mr-2 text-[10px]"></i> Baca ${item.count}x
                </div>` : "";
            
            const source = item.source ? 
                `<span class="block text-xs text-slate-400 font-medium uppercase tracking-wider mb-2">${item.source}</span>` : "";

            return `
                <div class="h-full flex-shrink-0 overflow-y-auto hide-scrollbar flex flex-col items-center relative" style="width: ${width}%">
                    <!-- 
                        RESPONSIVE CONTENT:
                        - Mobile: px-4 (standard padding)
                        - Desktop: max-w-sm (prevent text from getting too wide)
                    -->
                    <div class="w-full h-full flex flex-col items-center py-8 px-4 md:px-8">
                        <div class="my-auto w-full flex flex-col items-center max-w-md">
                            
                            ${count}
                            ${source}
                            <h3 class="text-emerald-700 font-bold text-lg mb-6 text-center leading-tight">${item.title}</h3>
                            
                            <!-- ARABIC TEXT: Fixed Desktop Overflow.
                                 Mobile: text-4xl
                                 Desktop (inside 480px app): capped at text-5xl (48px) to prevent messy overflow
                            -->
                            <div class="w-full mb-8 text-center" dir="rtl">
                                <p class="font-arabic text-4xl md:text-[2.75rem] text-slate-800 leading-[2.6] tracking-wide drop-shadow-sm select-text">
                                    ${item.arabic}
                                </p>
                            </div>

                            <!-- TRANSLATION AREA -->
                            <div class="w-full text-center pb-8">
                                ${item.latin ? `<p class="text-[15px] text-emerald-700 font-medium italic mb-4 leading-relaxed opacity-90">${item.latin}</p>` : ''}
                                <p class="text-[15px] md:text-base text-slate-600 leading-7 font-light">${item.translation}</p>
                                ${faedah}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderListView(dataType, title) {
            const data = DB[dataType] || [];
            const html = `
                <div class="h-full flex flex-col bg-slate-50 animate-fade-in rounded-t-xl">
                    <div class="flex items-center gap-4 p-4 bg-white shadow-sm sticky top-0 z-30 h-16">
                        <button onclick="navigateTo('home')" class="text-slate-500 hover:text-emerald-600 w-8 h-8 flex items-center justify-center">
                            <i class="fa-solid fa-arrow-left text-lg"></i>
                        </button>
                        <h2 class="text-lg font-bold text-slate-800">${title}</h2>
                    </div>
                    <div class="flex-grow overflow-y-auto p-4 space-y-4 pb-20">
                        ${data.map(item => `
                            <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100 hover:border-emerald-200 transition-colors">
                                <h3 class="font-bold text-emerald-700 mb-2 text-lg">${item.title}</h3>
                                <p class="text-slate-600 text-[15px] leading-relaxed mb-4">${item.content}</p>
                                <div class="bg-emerald-50/50 p-4 rounded-xl border border-emerald-100 flex flex-col items-center gap-2">
                                    <span class="text-[10px] text-emerald-600 font-bold uppercase tracking-wider bg-white px-2 py-0.5 rounded shadow-sm">Contoh</span>
                                    <span class="font-arabic text-3xl text-slate-800 mt-1">${item.example}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            root.innerHTML = html;
        }

        // ==========================================
        // 4. SLIDER ENGINE
        // ==========================================
        
        function updateSlidePosition() {
            const track = document.getElementById('slides-track');
            if(!track) return;

            const isRTL = AppState.isRTL;
            const index = AppState.currentIndex;
            const length = AppState.data.length;

            let translateX = 0;
            const step = 100 / length; 

            if (isRTL) {
                translateX = index * step; 
            } else {
                translateX = -(index * step);
            }

            track.style.transform = `translateX(${translateX}%)`;

            // Indicators
            const indicator = document.getElementById('slide-indicator');
            if(indicator) indicator.innerText = `${index + 1}/${length}`;

            // Dots
            AppState.data.forEach((_, i) => {
                const dot = document.getElementById(`dot-${i}`);
                if(dot) {
                    dot.classList.toggle('bg-emerald-500', i === index);
                    dot.classList.toggle('bg-gray-300', i !== index);
                }
            });
        }

        window.handleNavClick = function(direction) {
            let indexChange = direction;
            if (AppState.isRTL) indexChange = -direction; 
            let nextIndex = AppState.currentIndex + indexChange;
            
            if (nextIndex >= 0 && nextIndex < AppState.data.length) {
                AppState.currentIndex = nextIndex;
                updateSlidePosition();
            }
        }

        function initSwipeLogic() {
            const wrapper = document.querySelector('.slider-viewport');
            let startX = 0;
            let isDragging = false;
            if(!wrapper) return;

            wrapper.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
                isDragging = true;
            }, {passive: true});

            wrapper.addEventListener('touchend', (e) => {
                if (!isDragging) return;
                isDragging = false;
                const endX = e.changedTouches[0].clientX;
                const diff = startX - endX;
                const threshold = 50;
                
                if (Math.abs(diff) > threshold) {
                    // Logic Logic Swap for RTL
                    const isSwipeLeft = diff > 0;
                    if (isSwipeLeft) {
                        handleNavClick(AppState.isRTL ? 1 : 1); // Next visual
                    } else {
                        handleNavClick(AppState.isRTL ? -1 : -1); // Prev visual
                    }
                }
            });
        }

        // ==========================================
        // 5. BOOTSTRAP
        // ==========================================
        document.addEventListener('DOMContentLoaded', () => {
            fetchData();
            renderHome();
        });

    </script>
</body>
</html>
